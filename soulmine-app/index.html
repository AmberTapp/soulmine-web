<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover"/>
  <title>SoulMine ‚Äî Web3 –ó–Ω–∞–∫–æ–º—Å—Ç–≤–∞</title>
  <!-- –í–Ω–µ—à–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ -->
  <script src="https://unpkg.com/@tonconnect/sdk@latest/dist/tonconnect-sdk.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/face-api.js@1.5.0/dist/face-api.min.js"></script>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <link rel="stylesheet" href="styles/main.css">
</head>
<body>
  <!-- Splash Screen -->
  <div id="splash-screen" class="splash-screen">
    <div class="splash-content">
      <div class="splash-logo">üíú</div>
      <h1 class="splash-title">SoulMine</h1>
      <p class="splash-subtitle">Web3 –ó–Ω–∞–∫–æ–º—Å—Ç–≤–∞ —Å –¥—É—à–æ–π</p>
      <div class="splash-loader">
        <div class="loader-heart">‚ù§Ô∏è</div>
        <div class="loader-heart">‚ù§Ô∏è</div>
        <div class="loader-heart">‚ù§Ô∏è</div>
      </div>
    </div>
  </div>

  <div class="container">
    <!-- –û—Å–Ω–æ–≤–Ω–æ–π —ç–∫—Ä–∞–Ω -->
    <div id="main-screen" class="screen active">
      <!-- –õ–æ–≥–æ—Ç–∏–ø –∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫ -->
      <div class="hero-section">
        <h1 class="app-logo">üíú SoulMine</h1>
        <p class="app-slogan">Web3 –ó–Ω–∞–∫–æ–º—Å—Ç–≤–∞ —Å –¥—É—à–æ–π</p>
        <p class="app-desc">–°–≤–∞–π–ø–∞–π—Ç–µ, –Ω–∞—Ö–æ–¥–∏—Ç–µ, –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞–π—Ç–µ $LOVE</p>
        <p class="zero-friction-slogan">
          üí´ –ù–∏–∫–∞–∫–æ–π —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ ‚Äî –ø—Ä–æ—Å—Ç–æ –ø–æ–¥–∫–ª—é—á–∏—Ç–µ –∫–æ—à–µ–ª–µ–∫!
        </p>
      </div>

      <!-- –û–±–ª–∞—Å—Ç—å —Å–≤–∞–π–ø–æ–≤ (–æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç) -->
      <div id="swipe-area" class="swipe-area">
        <!-- –ö–∞—Ä—Ç–æ—á–∫–∏ –±—É–¥—É—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è —Å—é–¥–∞ -->
        <div class="placeholder-card">
          <p>–ü–æ–¥–∫–ª—é—á–∏—Ç–µ –∫–æ—à–µ–ª–µ–∫, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å —Å–≤–∞–π–ø–∞—Ç—å ‚ù§Ô∏è</p>
        </div>
      </div>

      <!-- –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π (–≤–Ω–∏–∑—É) -->
      <div class="action-buttons-fixed">
        <button class="action-btn chat-btn" onclick="openChatWithCurrent()" title="–ù–∞–ø–∏—Å–∞—Ç—å">
          üí¨
        </button>
        <button class="action-btn call-btn" onclick="startVoiceCallWithCurrent()" title="–ü–æ–∑–≤–æ–Ω–∏—Ç—å">
          üìû
        </button>
        <button class="action-btn video-btn" onclick="startVideoCallWithCurrent()" title="–í–∏–¥–µ–æ–∑–≤–æ–Ω–æ–∫">
          üìπ
        </button>
      </div>

      <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
      <div style="margin: 20px 0; display: flex; justify-content: center; gap: 10px; flex-wrap: wrap;">
        <button class="nav-btn" onclick="showScreen('profile')">üë§ –ü—Ä–æ—Ñ–∏–ª—å</button>
        <button class="nav-btn" onclick="showScreen('quests')">üéØ –ö–≤–µ—Å—Ç—ã</button>
        <button class="nav-btn" onclick="showScreen('history')">üìú –ò—Å—Ç–æ—Ä–∏—è</button>
        <button class="nav-btn" onclick="showScreen('dao')">üèõÔ∏è DAO</button>
      </div>

      <!-- –†–µ—Å—É—Ä—Å—ã -->
      <div class="resource-links">
        <a href="https://t.me/LoveSoulMine_Bot" target="_blank">üí¨ –ë–æ—Ç</a> |
        <a href="https://t.me/SoulMineNews" target="_blank">üì£ –ö–∞–Ω–∞–ª</a> |
        <a href="https://tonviewer.com/EQAf1n9pHB4gITeBj4VA6jYKa4QKAs7e1z5SSQY3DnYme-Yj" target="_blank">$LOVE</a>
      </div>

      <!-- –§—É—Ç–µ—Ä —Å –∫–Ω–æ–ø–∫–æ–π –∫–æ—à–µ–ª—å–∫–∞ -->
      <div class="footer-wallet">
        <button id="ton-connect-button" class="wallet-btn">
          <span class="wallet-icon">üîê</span>
          <span class="wallet-text">–ü–æ–¥–∫–ª—é—á–∏—Ç—å TON Wallet</span>
        </button>
        <div id="wallet-info" class="wallet-info" style="display:none; margin-top: 8px; font-size: 12px;">
          <strong>–ê–¥—Ä–µ—Å:</strong> <span id="wallet-address-display">‚Äî</span>
        </div>
        <p class="balance-display">–ë–∞–ª–∞–Ω—Å: <strong id="profile-balance">–ó–∞–≥—Ä—É–∑–∫–∞...</strong></p>
      </div>

      <div style="margin-top: 20px; font-size: 11px; color: #aaa; text-align: center;">
        <p>–°–æ–∑–¥–∞–Ω–æ –¥–ª—è TON ‚Äî –±–µ–∑–æ–ø–∞—Å–Ω–æ, –ø—Ä–∏–≤–∞—Ç–Ω–æ, —Å –º–∞–π–Ω–∏–Ω–≥–æ–º</p>
      </div>
    </div>

    <!-- –ß–∞—Ç -->
    <div id="chat-screen" class="screen">
      <h2>üí¨ –ß–∞—Ç</h2>
      <div id="messages" style="height: 400px; overflow-y: scroll; margin-bottom: 10px; padding: 10px; background: rgba(255,255,255,0.05); border-radius: 10px;"></div>
      <div class="chat-input">
        <input type="text" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..." onkeypress="sendMsg(event)">
        <button onclick="sendMsg()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
      </div>
      <div style="margin-top: 15px;">
        <button class="btn" onclick="showScreen('main-screen')">‚Üê –ù–∞–∑–∞–¥</button>
      </div>
    </div>

    <!-- –ü—Ä–æ—Ñ–∏–ª—å -->
    <div id="profile" class="screen">
      <h2>üë§ –ü—Ä–æ—Ñ–∏–ª—å</h2>
      <p>–ê–¥—Ä–µ—Å: <code id="profile-address">‚Äî</code></p>
      <p>–ë–∞–ª–∞–Ω—Å: <strong id="profile-balance-profile">‚Äî</strong></p>
      <h3>–í–∞—à–∏ NFT</h3>
      <div id="nft-container-profile"></div>
      <h3>–°–æ–≤–º–µ—Å—Ç–Ω—ã–µ NFT</h3>
      <div id="couple-nft-container-profile"></div>
      <button class="btn" onclick="showScreen('main-screen')">‚Üê –ù–∞–∑–∞–¥</button>
    </div>

    <!-- –ö–≤–µ—Å—Ç—ã -->
    <div id="quests" class="screen">
      <h2>üéØ –ö–≤–µ—Å—Ç—ã</h2>
      <p>–ü—Ä–æ–≥—Ä–µ—Å—Å: <strong id="quests-progress">0/3</strong></p>
      <div id="quests-list"></div>
      <button class="btn" onclick="showScreen('main-screen')">‚Üê –ù–∞–∑–∞–¥</button>
    </div>

    <!-- –ò—Å—Ç–æ—Ä–∏—è –∑–≤–æ–Ω–∫–æ–≤ -->
    <div id="history" class="screen">
      <h2>üìú –ò—Å—Ç–æ—Ä–∏—è –∑–≤–æ–Ω–∫–æ–≤</h2>
      <div id="call-history-list"></div>
      <button class="btn" onclick="showScreen('main-screen')">‚Üê –ù–∞–∑–∞–¥</button>
    </div>

    <!-- DAO -->
    <div id="dao" class="screen">
      <h2>üèõÔ∏è DAO ‚Äî –ì—Ä–∞–∂–¥–∞–Ω–∏–Ω SoulMine</h2>
      <p>–í–∞—à —É—Ä–æ–≤–µ–Ω—å: <strong id="citizen-nft-level">–ù–µ –≤—ã–¥–∞–Ω–æ. –°–æ–≤–µ—Ä—à–∏—Ç–µ –ø–µ—Ä–≤—ã–π –∑–≤–æ–Ω–æ–∫!</strong></p>
      <h3>–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è</h3>
      <div id="proposals-list"></div>
      <button class="btn" onclick="createProposal()">‚ûï –°–æ–∑–¥–∞—Ç—å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ</button>
      <button class="btn" onclick="showScreen('main-screen')">‚Üê –ù–∞–∑–∞–¥</button>
    </div>

    <!-- –ú–æ–¥–∞–ª–∫–∞ NFT -->
    <div id="nft-modal" class="modal">
      <div class="modal-content">
        <h2>üéâ –ù–æ–≤—ã–π NFT!</h2>
        <p style="font-size:4em; margin:10px;">"<span id="nft-name">–ù–∞–∑–≤–∞–Ω–∏–µ</span>"</p>
        <button onclick="closeModal()" style="padding:10px 20px; background:#00005B; color:white; border:none; border-radius:8px;">–ó–∞–∫—Ä—ã—Ç—å</button>
      </div>
    </div>

    <!-- –ú–æ–¥–∞–ª–∫–∞ –ø–æ–∏—Å–∫–∞ –ø–∞—Ä—Ç–Ω—ë—Ä–∞ -->
    <div id="searching-modal" class="modal">
      <div class="modal-content">
        <h2>üîç –ü–æ–∏—Å–∫ —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫–∞...</h2>
        <p>–ü–æ–¥–æ–∂–¥–∏—Ç–µ, –º—ã –ø–æ–¥–±–µ—Ä—ë–º –≤–∞–º –∏–¥–µ–∞–ª—å–Ω—É—é –ø–∞—Ä—É ‚ù§Ô∏è</p>
      </div>
    </div>

    <!-- –ú–æ–¥–∞–ª–∫–∞ –≤—ã–±–æ—Ä–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–ª—è AI-–ø–æ–∏—Å–∫–∞ -->
    <div id="ai-params-modal" class="modal">
      <div class="modal-content" style="max-width: 90%; padding: 20px;">
        <h2 style="margin-bottom: 20px;">‚ú® –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –≤–∞—à AI SoulMatch</h2>
        
        <div style="margin-bottom: 20px; text-align: left;">
          <label style="display: block; margin-bottom: 5px; font-weight: bold;">–í–æ–∑—Ä–∞—Å—Ç–Ω–æ–π –¥–∏–∞–ø–∞–∑–æ–Ω:</label>
          <select id="age-range" style="width: 100%; padding: 10px; border-radius: 8px; border: 1px solid #00005B;">
            <option value="18-25">18-25 –ª–µ—Ç</option>
            <option value="25-35">25-35 –ª–µ—Ç</option>
            <option value="35-45">35-45 –ª–µ—Ç</option>
            <option value="45+">45+ –ª–µ—Ç</option>
          </select>
        </div>

        <div style="margin-bottom: 20px; text-align: left;">
          <label style="display: block; margin-bottom: 5px; font-weight: bold;">–ò–Ω—Ç–µ—Ä–µ—Å—ã (–≤—ã–±–µ—Ä–∏—Ç–µ –¥–æ 3):</label>
          <div id="interests-container" style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
            <!-- –ò–Ω—Ç–µ—Ä–µ—Å—ã –±—É–¥—É—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã -->
          </div>
        </div>

        <div style="margin-bottom: 20px; text-align: left;">
          <label style="display: block; margin-bottom: 5px; font-weight: bold;">–¶–µ–ª—å –∑–Ω–∞–∫–æ–º—Å—Ç–≤–∞:</label>
          <select id="goal" style="width: 100%; padding: 10px; border-radius: 8px; border: 1px solid #00005B;">
            <option value="friendship">–î—Ä—É–∂–±–∞</option>
            <option value="romance">–†–æ–º–∞–Ω—Ç–∏–∫–∞</option>
            <option value="chat">–ü—Ä–æ—Å—Ç–æ –ø–æ–æ–±—â–∞—Ç—å—Å—è</option>
            <option value="mining">–ú–∞–π–Ω–∏—Ç—å $LOVE –≤–º–µ—Å—Ç–µ</option>
          </select>
        </div>

        <button onclick="saveAIParams()" style="padding: 12px 24px; background: #00005B; color: white; border: none; border-radius: 8px; font-size: 16px; cursor: pointer; width: 100%;">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏ –Ω–∞–π—Ç–∏ –ø–∞—Ä—É üíò</button>
      </div>
    </div>

    <!-- –í–∏–¥–µ–æ–∑–≤–æ–Ω–æ–∫ -->
    <div id="video-modal" class="modal">
      <div class="video-container">
        <div>
          <video id="local-video" autoplay muted playsinline></video>
          <video id="remote-video" autoplay playsinline></video>
        </div>
        <div id="video-timer">00:00</div>
        <div id="video-status">–û–∂–∏–¥–∞–Ω–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è...</div>
        <div style="margin-top: 10px;">
          <button class="btn" onclick="endVideoCall()">‚èπÔ∏è –ó–∞–≤–µ—Ä—à–∏—Ç—å –∑–≤–æ–Ω–æ–∫</button>
        </div>
      </div>
    </div>

    <!-- AR-—ç—Ñ—Ñ–µ–∫—Ç—ã -->
    <div id="ar-effects"></div>

    <!-- AR-—Ñ–∏–ª—å—Ç—Ä—ã -->
    <div style="display:none; margin-top: 10px; position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); z-index: 9999;">
      <button class="filter-btn" onclick="applyFilter('none')">‚ùå –í—ã–∫–ª—é—á–∏—Ç—å</button>
      <button class="filter-btn" onclick="applyFilter('hearts')">‚ù§Ô∏è –°–µ—Ä–¥—Ü–∞</button>
      <button class="filter-btn" onclick="applyFilter('ton')">üíé TON</button>
      <button class="filter-btn" onclick="applyFilter('party')">üéâ –í–µ—á–µ—Ä–∏–Ω–∫–∞</button>
      <button class="filter-btn" onclick="captureMoment()">üì∏ –ó–∞—Ö–≤–∞—Ç–∏—Ç—å</button>
    </div>
  </div>

  <!-- –ù–∞—à–∏ —Å–∫—Ä–∏–ø—Ç—ã -->
  <script src="scripts/utils.js"></script>
  <script src="scripts/ton.js"></script>
  <script src="scripts/quests.js"></script>
  <script src="scripts/dao.js"></script>
  <script src="scripts/video-call.js"></script>
  <script src="scripts/chat.js"></script>
  <script src="scripts/main.js"></script>
</body>
</html>